<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Warp your mobile development"/><link rel="canonical" href="http://blog.warpfactor.io/posts/2018-04-02-GlanceAtConditionalConformance"/><meta name="twitter:url" content="http://blog.warpfactor.io/posts/2018-04-02-GlanceAtConditionalConformance"/><meta name="og:url" content="http://blog.warpfactor.io/posts/2018-04-02-GlanceAtConditionalConformance"/><title>A glance at conditional conformance | Warp your mobile development</title><meta name="twitter:title" content="A glance at conditional conformance | Warp your mobile development"/><meta name="og:title" content="A glance at conditional conformance | Warp your mobile development"/><meta name="description" content="Swift 4.1 is available since a few days now and it comes with an interesting feature: Conditional conformance. This is a new tool for achieving Protocol Oriented Programming as well as API designing. This post is a quick take on this brand new technic and will be followed for sure by deep dive posts in a few weeks."/><meta name="twitter:description" content="Swift 4.1 is available since a few days now and it comes with an interesting feature: Conditional conformance. This is a new tool for achieving Protocol Oriented Programming as well as API designing. This post is a quick take on this brand new technic and will be followed for sure by deep dive posts in a few weeks."/><meta name="og:description" content="Swift 4.1 is available since a few days now and it comes with an interesting feature: Conditional conformance. This is a new tool for achieving Protocol Oriented Programming as well as API designing. This post is a quick take on this brand new technic and will be followed for sure by deep dive posts in a few weeks."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Warp your mobile development"/></head><head>                <!-- Global site tag (gtag.js) - Google Analytics -->
                <script async src="https://www.googletagmanager.com/gtag/js?id=UA-109460106-1"></script>
                <script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'UA-109460106-1');
                </script></head><body class="bg-white font-sans leading-normal tracking-normal"><div class="pb-16"><nav class="fixed z-10 bg-gray-900 p-4 mt-0 w-full overflow-auto scrolling-touch"><div class="container mx-auto flex items-center"><div class="flex-shrink-0 text-white font-extrabold"><a class="flex text-white text-base no-underline hover:text-white hover:no-underline" href="/"><span class="block md:hidden md:w-auto pl-1">üçé</span><span class="hidden md:block w-0 md:w-auto pl-1">Warp your mobile development</span></a></div><div class=" flex flex-no-wrap pl-4 text-sm"><ul class="list-reset flex justify-between items-center"><li class="mr-2"><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-2" href="/">HOME</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-2 whitespace-no-wrap" href="/projects">PROJECTS</a></li><li><a class="inline-block py-2 px-2 text-white no-underline hover:underline whitespace-no-wrap" href="/posts">MY POSTS</a></li></ul></div></div></nav></div><div class="text-center pt-16 md:pt-32"><p class="text-xs md:text-sm text-casper-blue font-bold">02 APRIL 2018<span class="text-gray-900 px-1">/</span><a href="/tags/language">LANGUAGE</a></p><h1 class="font-bold break-normal text-3xl md:text-5xl max-w-6xl mx-auto">A glance at conditional conformance</h1></div><div class="container w-full max-w-6xl h-48 md:h-cover mx-auto bg-white bg-cover bg-center mt-8 sm:rounded" style="background-color: #465059; background-image:url('/Images/2018-04-02-GlanceAtConditionalConformance/swift4.1.png');"></div><div class="container max-w-5xl mx-auto md:-mt-32"><div class="mx-0 sm:mx-6"><main class="bg-white w-full p-8 md:p-24 text-gray-800 leading-normal"><article class="prose prose-sm sm:prose-xl break-words"><p>Swift 4.1 is available since a few days now and it comes with an interesting feature: <strong>Conditional conformance</strong>. This is a new tool for achieving Protocol Oriented Programming as well as API designing. This post is a quick take on this brand new technic and will be followed for sure by deep dive posts in a few weeks.</p><h1>It's all about extensions</h1><p>With Swift, one can be a little bit confused with all the different ways of implementing extensions. As the language matures, new extensions possibilities come up and developers have to choose the good one ü§®.</p><h2>Basic extensions</h2><p>Basically an extension allows to augment the behavior of a type without having to subclass it:</p><pre><code><div class="highlight"><span></span><span class="kd">extension</span> <span class="nc">String</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">numberOf</span> <span class="p">(</span><span class="n">letter</span><span class="p">:</span> <span class="nb">Character</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">self</span><span class="p">.</span><span class="bp">filter</span> <span class="p">{</span> <span class="nv">$0</span> <span class="p">==</span> <span class="n">letter</span> <span class="p">}.</span><span class="bp">count</span>
    <span class="p">}</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">build</span> <span class="p">(</span><span class="n">withNumberOfSpaces</span> <span class="n">spaces</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">Int</span><span class="p">](</span><span class="mf">1.</span><span class="p">..</span><span class="n">spaces</span><span class="p">).</span><span class="bp">reduce</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="kc">_</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="k">in</span>
            <span class="k">return</span> <span class="n">previous</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
        <span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">blog</span> <span class="p">=</span> <span class="s">&quot;twittemb.github.io&quot;</span>
<span class="kd">let</span> <span class="nv">emptySpaces</span> <span class="p">=</span> <span class="nb">String</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">withNumberOfSpaces</span><span class="p">:</span> <span class="mi">10</span><span class="p">)</span>

<span class="bp">print</span> <span class="p">(</span><span class="s">&quot;Number of t in </span><span class="si">\(</span><span class="n">blog</span><span class="si">)</span><span class="s">: </span><span class="si">\(</span><span class="n">blog</span><span class="p">.</span><span class="n">numberOf</span><span class="si">(</span><span class="n">letter</span><span class="p">:</span> <span class="s">&quot;t&quot;</span><span class="si">))</span><span class="s">&quot;&quot;)</span>
<span class="s">/// will print: Number of t in twittemb.github.io: 4</span>

<span class="s">print (&quot;</span><span class="nb">String</span> <span class="n">from</span> <span class="n">factory</span><span class="p">:</span> <span class="o">|</span><span class="err">\</span><span class="p">(</span><span class="n">emptySpaces</span><span class="p">)</span><span class="o">|</span><span class="s">&quot;)</span>
<span class="s">/// will print: String from factory: |          |</span>
</div></code></pre><p>It is useful to make utility functions or to implement an efficient factory pattern.</p><h2>Conditional extensions</h2><p>There is a refinement to basic extension dedicated to generic types:</p><pre><code><div class="highlight"><span></span><span class="kd">extension</span> <span class="nc">Array</span> <span class="k">where</span> <span class="n">Element</span><span class="p">:</span> <span class="n">Numeric</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">sum</span> <span class="p">()</span> <span class="p">-&gt;</span> <span class="n">Element</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">self</span><span class="p">.</span><span class="bp">reduce</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">+</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">numerics</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">]</span>
<span class="bp">print</span> <span class="p">(</span><span class="s">&quot;Sum of elements in </span><span class="si">\(</span><span class="n">numerics</span><span class="si">)</span><span class="s">: </span><span class="si">\(</span><span class="n">numerics</span><span class="p">.</span><span class="n">sum</span><span class="si">())</span><span class="s">&quot;</span><span class="p">)</span>

<span class="c1">/// will print: Sum of elements in [1.0, 2.0, 3.0, 4.0, 5.5]: 15.5</span>
</div></code></pre><p>It would probably not make sense to apply a sum() function to an Array of Bool for instance. This kind of extension allows the developer to bring new features to an existing type but make them safe to use at the same time. It is something very useful when you're designing an API that is to be used by other developers. They can benefit some code for "free" once and only once they meet the good requirements.</p><h2>Conformance extensions</h2><p>Not only can extensions add behaviors to existing types but also can they amend a type itself to make it conform to a Protocol.</p><pre><code><div class="highlight"><span></span><span class="kd">protocol</span> <span class="nc">Resettable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">reset</span> <span class="p">()</span> <span class="p">-&gt;</span> <span class="kc">Self</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="nc">String</span><span class="p">:</span> <span class="n">Resettable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">reset</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="nc">Int</span><span class="p">:</span> <span class="n">Resettable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">reset</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="nc">Optional</span><span class="p">:</span> <span class="n">Resettable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">reset</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Optional</span><span class="p">&lt;</span><span class="n">Wrapped</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">name</span> <span class="p">=</span> <span class="s">&quot;Spock&quot;</span>
<span class="kd">let</span> <span class="nv">age</span> <span class="p">=</span> <span class="mi">120</span>
<span class="kd">let</span> <span class="nv">isVulcan</span><span class="p">:</span> <span class="nb">Bool</span><span class="p">?</span> <span class="p">=</span> <span class="kc">true</span>

<span class="kd">let</span> <span class="nv">resettables</span><span class="p">:</span> <span class="p">[</span><span class="n">Resettable</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Spock&quot;</span><span class="p">,</span> <span class="mi">120</span> <span class="p">,</span> <span class="n">isVulcan</span><span class="p">]</span>
<span class="bp">print</span> <span class="p">(</span><span class="s">&quot;Array before reset: </span><span class="si">\(</span><span class="n">resettables</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="c1">/// will print: Array before reset: [&quot;Spock&quot;, 120, Optional(true)]</span>

<span class="kd">let</span> <span class="nv">reset</span> <span class="p">=</span> <span class="n">resettables</span><span class="p">.</span><span class="bp">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">reset</span><span class="p">()</span> <span class="p">}</span>
<span class="bp">print</span> <span class="p">(</span><span class="s">&quot;Array after reset: </span><span class="si">\(</span><span class="n">reset</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="c1">/// will print: Array after reset: [&quot;&quot;, 0, nil]</span>
</div></code></pre><p>This brings uniformity where there was heterogeneity. It would have been impossible to mix <strong>Strings</strong>, <strong>Ints</strong> and <strong>Optionals</strong> into an <strong>Array</strong> without having them conformed to the same Protocol.</p><p>But, although every element of the Array is a "<strong>Resettable</strong>", we still have to parse it (with <strong>map</strong>) and call "<strong>reset()</strong>" on each of these to achieve a global operation.</p><p>Conditional conformace will help a lot in making this operation seamless for the developer who wants to reset the whole Array.</p><h2>Protocol extensions</h2><p>So far we haven't spoken about Protocol Oriented Programming. This paradigm comes with the ability to add a default behavior to a Protocol. Types that conform to this protocol will benefit this default behavior as well (or override it). It is a special type of extension and it is not really the point of this blog post. So, let's not introduce to much noise here and focus on the ability to extend a concrete type.</p><h1>Conform only if ‚Ä¶</h1><p><strong>Conditional conformance</strong> is the brand new feature that comes with Swift 4.1. It is a mix between <strong>conditional extension</strong> and <strong>conformance extension</strong>. Being so, it inherits both of their key principles:</p><ul><li>bring new features but make them safe to use at the same time</li><li>bring uniformity where there was heterogeneity</li></ul><p>In fact one of the main idea behind that is: if a behavior can be applied to each element of a superset, then we can consider that this behavior can also be applied to the superset itself :</p><pre><code><div class="highlight"><span></span><span class="kd">extension</span> <span class="nc">Array</span><span class="p">:</span> <span class="n">Resettable</span> <span class="k">where</span> <span class="n">Element</span> <span class="p">==</span> <span class="n">Resettable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">reset</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">Array</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">self</span><span class="p">.</span><span class="bp">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">reset</span><span class="p">()</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">innerResettableArray</span><span class="p">:</span> <span class="p">[</span><span class="n">Resettable</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Spock&quot;</span><span class="p">,</span> <span class="mi">120</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">resettableArray</span><span class="p">:</span> <span class="p">[</span><span class="n">Resettable</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Kirk&quot;</span><span class="p">,</span>
                                      <span class="mi">45</span><span class="p">,</span>
                                      <span class="nb">Optional</span><span class="p">&lt;</span><span class="nb">Bool</span><span class="p">&gt;(</span><span class="kc">true</span><span class="p">),</span>
                                      <span class="n">innerResettableArray</span><span class="p">]</span>

<span class="bp">print</span> <span class="p">(</span><span class="s">&quot;Array before reset: </span><span class="si">\(</span><span class="n">resettableArray</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="c1">/// will print: Array before reset: [&quot;Kirk&quot;, 45, Optional(true), [&quot;Spock&quot;, 120]]</span>

<span class="bp">print</span> <span class="p">(</span><span class="s">&quot;Array after reset: </span><span class="si">\(</span><span class="n">resettableArray</span><span class="p">.</span><span class="n">reset</span><span class="si">())</span><span class="s">&quot;</span><span class="p">)</span>
<span class="c1">/// will print: Array after reset: [&quot;&quot;, 0, nil, [&quot;&quot;, 0]]</span>
</div></code></pre><p>As every element of the Array is <strong>Resettable</strong>, so is the whole Array. It is exactly what Apple has done with Equatable and Hashable for instance. With Swift 4.1, an Array of Elements that are Equatables, is Equatable itself.</p><p>What's great and very powerful in our example is that we can embed an Array of Resettables inside the root Array, and with only one statement "<strong>resettableArray.reset()</strong>", the whole data structure is being reset. It is a very elegant way to deal with <strong>recursivity</strong>.</p><p>As we can see, in terms of API designing we have a great benefit in using "<strong>Conditional conformance</strong>" over basic "<strong>Conformance extension</strong>". The API designer will internalize in its framework the code (here the <strong>reset()</strong> function) he thinks smart to offer for free to the developers who match the appropriate requirements.</p><h2>Leverage conditional conformance to ease Design Patterns implementation</h2><p>There are certain kinds of design patterns that can benefit from the ability that comes with conditional conformance to make a behavior apply to a "container" type. Again, this is mostly seen from an API designer perspective.</p><p><strong>Visitor</strong> is a pretty simple Design Pattern that allows to externalize the parsing of a data structure. If you want a detailed explanation: <a href="https://en.wikipedia.org/wiki/Visitor_pattern">Visitor Pattern</a>.</p><p>Here, we will implement <strong>Persons</strong> and <strong>Cars,</strong>&nbsp;data structures that are "<strong>Visitables</strong>". With conditional conformance, <strong>Containers</strong> of "<strong>Visitables</strong>" will be "<strong>Visitable</strong>" as well:</p><pre><code><div class="highlight"><span></span><span class="kd">protocol</span> <span class="nc">Visitor</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span> <span class="p">(</span><span class="n">visitable</span><span class="p">:</span> <span class="n">Visitable</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="nc">Visitable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span> <span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">Visitor</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">/// a Person can be visited</span>
<span class="kd">struct</span> <span class="nc">Person</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">name</span><span class="p">:</span> <span class="nb">String</span>
    <span class="kd">let</span> <span class="nv">age</span><span class="p">:</span> <span class="nb">Int</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="nc">Person</span><span class="p">:</span> <span class="n">Visitable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span> <span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">Visitor</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kc">self</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="p">{</span>
            <span class="n">visitor</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="n">visitable</span><span class="p">:</span> <span class="kc">self</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">/// a Car can be visited</span>
<span class="kd">struct</span> <span class="nc">Car</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">isElectric</span><span class="p">:</span> <span class="nb">Bool</span>
    <span class="kd">let</span> <span class="nv">model</span><span class="p">:</span> <span class="nb">String</span>
    <span class="kd">let</span> <span class="nv">price</span><span class="p">:</span> <span class="nb">Double</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="nc">Car</span><span class="p">:</span> <span class="n">Visitable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span> <span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">Visitor</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kc">self</span><span class="p">.</span><span class="n">isElectric</span> <span class="p">{</span>
            <span class="n">visitor</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="n">visitable</span><span class="p">:</span> <span class="kc">self</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">/// an Array of Visitables is also Visitable</span>
<span class="kd">extension</span> <span class="nc">Array</span><span class="p">:</span> <span class="n">Visitable</span> <span class="k">where</span> <span class="n">Element</span> <span class="p">==</span> <span class="n">Visitable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span> <span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">Visitor</span><span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">accept</span><span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">visitor</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">/// an Dictionary of Visitables is also Visitable</span>
<span class="kd">extension</span> <span class="nc">Dictionary</span><span class="p">:</span> <span class="n">Visitable</span> <span class="k">where</span> <span class="n">Value</span> <span class="p">==</span> <span class="n">Visitable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span> <span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">Visitor</span><span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">accept</span><span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">visitor</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">AnyVisitor</span><span class="p">:</span> <span class="n">Visitor</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span> <span class="p">(</span><span class="n">visitable</span><span class="p">:</span> <span class="n">Visitable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">visitable</span> <span class="p">{</span>
        <span class="k">case</span> <span class="kd">let</span> <span class="nv">person</span> <span class="k">as</span> <span class="n">Person</span><span class="p">:</span>
            <span class="bp">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="si">\(</span><span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="si">)</span><span class="s"> is </span><span class="si">\(</span><span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="si">)</span><span class="s"> years old&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="kd">let</span> <span class="nv">car</span> <span class="k">as</span> <span class="n">Car</span><span class="p">:</span>
            <span class="bp">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="si">\(</span><span class="n">car</span><span class="p">.</span><span class="n">model</span><span class="si">)</span><span class="s">&#39;s price is </span><span class="si">\(</span><span class="n">car</span><span class="p">.</span><span class="n">price</span><span class="si">)</span><span class="s">$&quot;</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="bp">print</span> <span class="p">(</span><span class="n">visitable</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">ironman</span> <span class="p">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Tony Stark&quot;</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="mi">45</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">hulk</span> <span class="p">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Bruce Banner&quot;</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="mi">40</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">captain</span> <span class="p">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Steve Rogers&quot;</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="mi">29</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">spiderman</span> <span class="p">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&quot;Peter Parker&quot;</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="mi">16</span><span class="p">)</span>

<span class="kd">let</span> <span class="nv">tesla</span> <span class="p">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">isElectric</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s">&quot;Roadster&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mi">120000</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">porsche</span> <span class="p">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">isElectric</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s">&quot;911&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mi">250000</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">ferrari</span> <span class="p">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">isElectric</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s">&quot;GTO&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">nissan</span> <span class="p">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">isElectric</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s">&quot;Leaf&quot;</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="mi">30000</span><span class="p">)</span>

<span class="kd">let</span> <span class="nv">arrayToVisit</span><span class="p">:</span> <span class="p">[</span><span class="n">Visitable</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span><span class="n">ironman</span><span class="p">,</span> <span class="n">spiderman</span><span class="p">,</span> <span class="n">tesla</span><span class="p">,</span> <span class="n">porsche</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">dictionnaryToVisit</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">:</span> <span class="n">Visitable</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span> <span class="s">&quot;key1&quot;</span><span class="p">:</span> <span class="n">hulk</span><span class="p">,</span>
                                                <span class="s">&quot;key2&quot;</span><span class="p">:</span> <span class="n">captain</span><span class="p">,</span>
                                                <span class="s">&quot;key3&quot;</span><span class="p">:</span> <span class="n">ferrari</span><span class="p">,</span>
                                                <span class="s">&quot;key4&quot;</span><span class="p">:</span> <span class="n">nissan</span><span class="p">,</span>
                                                <span class="s">&quot;key5&quot;</span><span class="p">:</span> <span class="n">arrayToVisit</span><span class="p">]</span>

<span class="kd">let</span> <span class="nv">anyVisitor</span> <span class="p">=</span> <span class="n">AnyVisitor</span><span class="p">()</span>
<span class="n">dictionnaryToVisit</span><span class="p">.</span><span class="n">accept</span><span class="p">(</span><span class="n">visitor</span><span class="p">:</span> <span class="n">anyVisitor</span><span class="p">)</span>

<span class="c1">/// will print:</span>
<span class="c1">/// Leaf&#39;s price is 30000.0$</span>
<span class="c1">/// Tony Stark is 45 years old</span>
<span class="c1">/// Roadster&#39;s price is 120000.0$</span>
<span class="c1">/// Bruce Banner is 40 years old</span>
</div></code></pre><p>To visit a bunch of <strong>Visitables</strong>, all you have to do is adding them to a container such as an <strong>Array</strong> or a <strong>Dictionnary</strong> and visit this one. From the Developer perspective, only the <strong>AnyVisitor</strong> has to be implemented.</p><h2>Be careful with auto-completion</h2><p>There is a small drawback in using <strong>conditional conformance</strong> with XCode. If we get back to our <strong>Resettable</strong> example, <strong>Bool</strong> is not Resettable but if we declare an <strong>Array&lt;Bool&gt;</strong>, XCode will offer the <strong>reset()</strong> function with the auto-completion.</p><p>Of course the compiler will then inform you that Bool is not a Resettable ‚Ä¶ but still, perhaps XCode could have been more restrictive ! Not that big a deal üòä but I had to point that out.</p><p>I hope you enjoyed this first take on conditional conformance. New usages will come out for sure in the weeks to come.</p><p>Stay tuned.</p></article></main><div class="flex flex-wrap w-full items-center font-sans p-8 md:p-24"><div class="md:flex-1 flex"><img class="w-10 h-10 rounded-full mr-4" src="/Images/avatar.png" alt="Thibault Wittemberg"/><div class="flex-1"><p class="text-base font-bold text-base md:text-xl leading-none">Thibault Wittemberg</p><p class="text-gray-600 text-xs md:text-base">Mobile Solution Architect in France üá´üá∑ (thibault.wittemberg@gmail.com)</p></div></div><div class="mt-8 md:mt-0 mx-auto md:mx-0 md:justify-end"><a class="bg-transparent border border-gray-500 hover:border-casper-blue text-xs text-gray-500 hover:text-casper-blue font-bold py-2 px-4 rounded-full" href="/tags">All tags</a></div></div></div></div><div class="bg-gray-200"><div class="container w-full max-w-6xl mx-auto px-2 py-8"><div class="grid grid-cols-1 sm:grid-cols-3 gap-12"><div class="w-full  py-6 flex flex-col flex-grow flex-shrink transform transition duration-200 ease-in-out hover:scale-105"><div class="flex-1 bg-white rounded-t rounded-b-none overflow-hidden shadow-lg"><a href="/posts/2018-01-02-ProtocolOrientedTipsMvvm" class="flex flex-wrap no-underline hover:no-underline"><img src="/Images/2018-01-02-ProtocolOrientedTipsMvvm/POP-MVVM.png" class="h-64 w-full rounded-t object-cover"/><p class="w-full text-casper-blue text-xs font-medium pt-6 px-6">TIPS, ARCHITECTURE</p><div class="w-full font-bold text-2xl text-gray-900 px-6">Protocol Oriented Tips For MVVM in Swift</div><p class="text-gray-800 font-serif text-lg px-6 mb-5">Hi folks. Lately MVVM has become some sort of standard as an architecture for iOS apps. It offers a good separation of concerns, a good way to format data and great view binding mechanisms with frameworks such as RxSwift. In this post I will give few tips I use to ease the implementation of this pattern.</p></a></div><div class="flex-none mt-auto bg-white rounded-b rounded-t-none overflow-hidden shadow-lg p-6"><div class="flex items-center justify-between"><img class="w-8 h-8 rounded-full mr-4 avatar" src="/Images/avatar.png" alt="Thibault Wittemberg"/><p class="text-gray-600 text-xs md:text-sm">8 MIN READ</p></div></div></div><div class="w-full  py-6 flex flex-col flex-grow flex-shrink transform transition duration-200 ease-in-out hover:scale-105"><div class="flex-1 bg-white rounded-t rounded-b-none overflow-hidden shadow-lg"><a href="/posts/2018-06-25-RxReduce-Part2" class="flex flex-wrap no-underline hover:no-underline"><img src="/Images/2018-06-25-RxReduce-Part2/RxReduce_Logo.png" class="h-64 w-full rounded-t object-cover"/><p class="w-full text-casper-blue text-xs font-medium pt-6 px-6">ARCHITECTURE, REACTIVE PROGRAMMING, OPEN SOURCE</p><div class="w-full font-bold text-2xl text-gray-900 px-6">RxReduce: Reactive State Container Architecture Part 2</div><p class="text-gray-800 font-serif text-lg px-6 mb-5">As we saw in ‚ÄúRxReduce: A Reactive State Container Architecture Part 1‚Äù, State is a central concern in applications. I strongly invite you to take a look at this first article. So far, we haven‚Äôt introduced the concept of Reactive Programming and how it can address some issues I‚Äôve encountered in traditional implementations of State Containers. We will see how RxReduce, an open source framework of the RxSwiftCommunity, can help you handle the State, its mutations, and the asynchronous work related to the side effects, in a Reactive way.</p></a></div><div class="flex-none mt-auto bg-white rounded-b rounded-t-none overflow-hidden shadow-lg p-6"><div class="flex items-center justify-between"><img class="w-8 h-8 rounded-full mr-4 avatar" src="/Images/avatar.png" alt="Thibault Wittemberg"/><p class="text-gray-600 text-xs md:text-sm">11 MIN READ</p></div></div></div><div class="w-full  py-6 flex flex-col flex-grow flex-shrink transform transition duration-200 ease-in-out hover:scale-105"><div class="flex-1 bg-white rounded-t rounded-b-none overflow-hidden shadow-lg"><a href="/posts/2019-06-18-PropertyWrappers" class="flex flex-wrap no-underline hover:no-underline"><img src="/Images/2019-06-18-PropertyWrappers/wrapper.png" class="h-64 w-full rounded-t object-cover"/><p class="w-full text-casper-blue text-xs font-medium pt-6 px-6">LANGUAGE</p><div class="w-full font-bold text-2xl text-gray-900 px-6">Property Wrappers In Swift 5.1, The Missing Published Implementation</div><p class="text-gray-800 font-serif text-lg px-6 mb-5">It‚Äôs been an amazing WWDC this year. SwiftUI and Combine were some big announcements of the conference. They will have a huge impact on our daily life as iOS developers.</p></a></div><div class="flex-none mt-auto bg-white rounded-b rounded-t-none overflow-hidden shadow-lg p-6"><div class="flex items-center justify-between"><img class="w-8 h-8 rounded-full mr-4 avatar" src="/Images/avatar.png" alt="Thibault Wittemberg"/><p class="text-gray-600 text-xs md:text-sm">6 MIN READ</p></div></div></div></div></div></div><footer class="bg-gray-900"><div class="container max-w-6xl mx-auto flex items-center px-2 pt-2 pb-8"><div class="w-full mx-auto flex flex-wrap items-center"><div class="flex w-full md:w-1/2 justify-center md:justify-start text-white font-extrabold"><p><a class="text-gray-900 no-underline hover:text-gray-900 hover:no-underline" href="#"><span class="text-base text-gray-200">Warp your mobile development</span></a></p></div><div class="flex w-full pt-2 content-center justify-between md:w-1/2 md:justify-end"><ul class="list-reset flex justify-center flex-1 md:flex-none items-center"><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-3 text-sm" href="/">Latest Posts</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-3 text-sm" href="https://github.com/JohnSundell/Publish">Publish</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-3 text-sm" href="https://ghost.org">Ghost</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline px-3 text-sm" href="/feed.rss"><svg class="fill-current h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg></a></li></ul></div></div></div></footer></body></html>